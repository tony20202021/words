# Структура директорий проекта

Полная структура проекта для перевода китайских слов с использованием LLM:

```
repos/words/translation_summary/
│
├── src/                           # Исходные коды (модульная архитектура)
│   ├── __init__.py               # Инициализация пакета
│   ├── model_config.py           # Конфигурация моделей и типов
│   ├── model_loader.py           # Загрузчик моделей и токенизаторов
│   ├── prompt_generator.py       # Генератор промптов для разных моделей
│   ├── seq2seq_handler.py        # Обработчик seq2seq моделей перевода
│   ├── llm_translator.py         # Основной класс переводчика
│   ├── chinese_translator.py     # Оригинальный модуль (без LLM)
│   ├── chinese_translator_llm.py # Модуль для обработки JSON с LLM
│   └── generate_comparison_table.py # Генератор сравнительных таблиц
│
├── tests/                         # Тесты
│   ├── __init__.py               # Инициализация пакета тестов
│   ├── test_translator.py        # Демонстрационный тест базового переводчика
│   ├── test_unit.py              # Модульные тесты базового переводчика
│   └── test_llm.py               # Тестирование LLM-моделей для перевода
│
├── data/                          # Директория для данных
│   └── examples/                 # Примеры данных
│       └── sample_words.json     # Пример файла с китайскими словами
│
├── results/                       # Результаты выполнения
│   ├── run_20250522_143015/      # Каталог конкретного запуска
│   │   ├── results_qwen2-1.5b.json          # Результаты модели с описанием
│   │   ├── results_qwen2-1.5b_no_desc.json  # Результаты модели без описания
│   │   ├── results_bloom-3b.json             # Результаты другой модели
│   │   ├── comparison.md                     # Сравнительная таблица Markdown
│   │   ├── comparison.csv                    # Сравнительная таблица CSV
│   │   └── run.log                          # Лог выполнения
│   └── latest/                   # Символическая ссылка на последний запуск
│
├── cache/                         # Кэш для моделей и переводов
│   └── .gitkeep                  # Файл для сохранения пустой директории в git
│
├── logs/                          # Логи выполнения
│   └── .gitkeep                  # Файл для сохранения пустой директории в git
│
├── main.py                        # Основной скрипт запуска базового переводчика
├── main_llm.py                    # Основной скрипт запуска с LLM
├── run_models.sh                  # Скрипт для демонстрации различных моделей
│
├── README.md                      # Основная документация
├── README_LLM.md                  # Документация по LLM-решению
├── environment.yml                # Окружение conda
├── requirements.txt               # Зависимости pip
├── project_description.md         # Техническое описание проекта
└── directory_structure.md         # Этот файл - структура директорий
```

## Описание основных файлов

### Модульная архитектура src/

| Файл | Описание |
|------|----------|
| `model_config.py` | Конфигурация всех доступных моделей, их типов и особенностей |
| `model_loader.py` | Загрузка моделей и токенизаторов с кэшированием и оптимизацией |
| `prompt_generator.py` | Создание специализированных промптов для разных типов моделей |
| `seq2seq_handler.py` | Специальная обработка seq2seq моделей (NLLB, MBart, OpusMT) |
| `llm_translator.py` | Основной класс переводчика, координирующий работу всех модулей |
| `chinese_translator_llm.py` | Модуль для обработки JSON-файла с использованием LLM |
| `generate_comparison_table.py` | Генерация сравнительных таблиц в форматах Markdown и CSV |

### Скрипты запуска

| Файл | Описание |
|------|----------|
| `main.py` | Запуск базового переводчика (без LLM) |
| `main_llm.py` | Запуск переводчика с использованием LLM |
| `run_models.sh` | Автоматическое тестирование всех моделей в обоих режимах |

### Тесты

| Файл | Описание |
|------|----------|
| `tests/test_translator.py` | Демонстрационный тест базового переводчика |
| `tests/test_unit.py` | Модульные тесты для проверки базового переводчика |
| `tests/test_llm.py` | Тестирование и сравнение результатов LLM-моделей |

### Конфигурация и документация

| Файл | Описание |
|------|----------|
| `requirements.txt` | Зависимости для pip |
| `environment.yml` | Окружение conda |
| `README.md` | Основная документация проекта |
| `README_LLM.md` | Специализированная документация по LLM-решению |
| `project_description.md` | Техническое описание и спецификация проекта |

## Сценарии использования

### 1. Базовый переводчик
```bash
python main.py -i data/examples/sample_words.json
```

### 2. Переводчик с легкой LLM-моделью
```bash
python main_llm.py -i data/examples/sample_words.json -m qwen2-1.5b
```

### 3. Переводчик с продвинутой LLM-моделью
```bash
python main_llm.py -i data/examples/sample_words.json -m bloom-7b1
```

### 4. Режим без использования описаний
```bash
python main_llm.py -i data/examples/sample_words.json -m nllb-1.3b --no-description
```

### 5. Автоматическое тестирование всех моделей
```bash
bash run_models.sh
```

### 6. Сравнительный тест конкретных моделей
```bash
python tests/test_llm.py -m qwen2-1.5b bloom-3b --show-desc
```

## Результаты выполнения

### Структура каталога results/
Каждый запуск `run_models.sh` создает новый каталог с временной меткой:

```
results/
├── run_20250522_143015/          # Запуск от 22.05.2025 14:30:15
│   ├── results_qwen2-1.5b.json           # Результаты Qwen2-1.5B с описанием
│   ├── results_qwen2-1.5b_no_desc.json   # Результаты Qwen2-1.5B без описания
│   ├── results_bloom-3b.json             # Результаты BLOOM-3B с описанием
│   ├── results_bloom-3b_no_desc.json     # Результаты BLOOM-3B без описания
│   ├── results_nllb-600m.json            # Результаты NLLB-600M с описанием
│   ├── results_nllb-600m_no_desc.json    # Результаты NLLB-600M без описания
│   ├── comparison.md                      # Сравнительная таблица Markdown
│   ├── comparison.csv                     # Полные данные в CSV
│   └── run.log                           # Подробный лог выполнения
└── latest -> run_20250522_143015/        # Ссылка на последний запуск
```

### Содержание файлов результатов

#### JSON файлы с результатами
Содержат переводы и метаданные:
```json
{
  "word_1": {
    "character": "的",
    "description": "притяжательная частица",
    "long_description": ["Притяжательная частица...", "..."],
    "transcription": "de",
    "frequency": 100000
  },
  "_meta": {
    "model": "qwen2-1.5b",
    "mode": "с описанием",
    "processing_time": 45
  }
}
```

#### Markdown таблица (comparison.md)
- Сравнительная таблица всех переводов
- Информация о времени выполнения
- Примеры сравнения режимов
- Анализ результатов

#### CSV файл (comparison.csv)
- Полные данные без сокращений
- Удобен для анализа в Excel или программном анализе
- Включает время выполнения для каждой модели

## Рекомендуемые модели по категориям

### Для слабых GPU (6-8 ГБ)
| Модель | Размер | Особенности |
|--------|--------|-------------|
| qwen2-1.5b | 1.5B | Лучшее качество для китайского |
| bloom-3b | 3B | Хорошая поддержка русского и китайского |
| mgpt | 1.7B | Многоязычные задачи |
| nllb-600m | 600M | Специализированный перевод |

### Для мощных GPU (16+ ГБ)
| Модель | Размер | Особенности |
|--------|--------|-------------|
| qwen2-7b | 7B | Лучшее качество для китайского |
| bloom-7b1 | 7B | Сбалансированная многоязычная модель |
| mistral-7b | 7B | Современная модель с хорошими характеристиками |
| baichuan-7b | 7B | Специализированная китайская модель |
| wenzhong | 3.5B | Китайская модель с trust_remote_code |

### Специализированные модели перевода
| Модель | Тип | Языки |
|--------|-----|-------|
| nllb-1.3b | seq2seq | 200+ языков |
| mbart-50 | seq2seq | 50 языков |
| opus-mt-zh-en | seq2seq | Китайский → Английский |
| m2m100 | seq2seq | Многоязычный перевод |
