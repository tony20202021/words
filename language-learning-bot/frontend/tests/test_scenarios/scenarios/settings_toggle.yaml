name: Settings Toggle Scenario YAML
user_id: 123456789
api_mock: common
auto_setup: true
steps:
  - type: command
    name: settings
    asserts:
      - type: message_contains
        position: -1
        text: "–°–Ω–∞—á–∞–ª–∞ –≤—ã–±–µ—Ä–∏—Ç–µ —è–∑—ã–∫ –¥–ª—è –∏–∑—É—á–µ–Ω–∏—è —Å –ø–æ–º–æ—â—å—é –∫–æ–º–∞–Ω–¥—ã /language"

  # –®–∞–≥ 3: –ò–º–∏—Ç–∏—Ä—É–µ–º –≤—ã–±–æ—Ä —è–∑—ã–∫–∞ —á–µ—Ä–µ–∑ callback
  - type: callback
    data: "lang_select_eng"
    asserts:
      - type: message_contains
        text: "–í—ã –≤—ã–±—Ä–∞–ª–∏ —è–∑—ã–∫: <b>–ê–Ω–≥–ª–∏–π—Å–∫–∏–π (English)</b>"
      - type: message_contains
        text: "–í–∞—à–∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –¥–ª—è —ç—Ç–æ–≥–æ —è–∑—ã–∫–∞"
      - type: message_contains
        text: "–ò—Å–∫–ª—é—á–µ–Ω–Ω—ã–µ —Å–ª–æ–≤–∞: <b>–ü—Ä–æ–ø—É—Å–∫–∞—Ç—å ‚ùå</b>"
      - type: message_contains
        text: "–ü–µ—Ä–∏–æ–¥ –ø–æ–≤—Ç–æ—Ä–µ–Ω–∏—è: <b>–£—á–∏—Ç—ã–≤–∞—Ç—å ‚úÖ</b>"
      - type: message_contains
        text: "–ù–∞—Å—Ç—Ä–æ–∏—Ç—å –ø—Ä–æ—Ü–µ—Å—Å –æ–±—É—á–µ–Ω–∏—è: /settings"
      - type: state_contains
        data: ["_state", None]
      - type: state_contains
        data: ["current_language", {"id": "eng", "name_ru": "–ê–Ω–≥–ª–∏–π—Å–∫–∏–π", "name_foreign": "English"}]

  # –®–∞–≥ 4: –û—Ç–∫—Ä—ã–≤–∞–µ–º –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —Å–Ω–æ–≤–∞
  - type: command
    name: settings
    asserts:
      - type: message_contains
        text: "–¢–µ–∫—É—â–∏–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏"
      - type: message_contains
        text: "–ò—Å–∫–ª—é—á–µ–Ω–Ω—ã–µ —Å–ª–æ–≤–∞: <b>–ü—Ä–æ–ø—É—Å–∫–∞—Ç—å ‚ùå</b>"
      - type: message_contains
        text: "–ü–µ—Ä–∏–æ–¥ –ø–æ–≤—Ç–æ—Ä–µ–Ω–∏—è: <b>–£—á–∏—Ç—ã–≤–∞—Ç—å ‚úÖ</b>"
      - type: state_contains
        data: ["_state", SettingsStates:viewing_settings]
      - type: keyboard_contains
        button_text: "‚ùå –ò—Å–∫–ª—é—á–µ–Ω–Ω—ã–µ —Å–ª–æ–≤–∞"
      - type: keyboard_contains
        button_text: "‚úÖ –£—á–∏—Ç—ã–≤–∞—Ç—å –¥–∞—Ç—É"
      - type: keyboard_button_count
        count: 13

  # –®–∞–≥ 5: –ü–µ—Ä–µ–∫–ª—é—á–∞–µ–º –Ω–∞—Å—Ç—Ä–æ–π–∫—É –ø—Ä–æ–ø—É—Å–∫–∞ –ø–æ–º–µ—á–µ–Ω–Ω—ã—Ö —Å–ª–æ–≤
  - type: callback
    data: CallbackData.SETTINGS_TOGGLE_SKIP_MARKED
    asserts:
      - type: message_contains
        text: "–¢–µ–∫—É—â–∏–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏"
      - type: message_contains
        text: "–ò—Å–∫–ª—é—á–µ–Ω–Ω—ã–µ —Å–ª–æ–≤–∞: <b>–ü—Ä–æ–ø—É—Å–∫–∞—Ç—å ‚ùå</b>"
      # - type: state_contains
      #   data: ["skip_marked", true] # TODO –∏—Å–ø—Ä–∞–≤–∏—Ç—å –º–æ–∫ 'skip_marked': <MagicMock name='mock.bot.api_client.get_user_language_settings().__getitem__().__getitem__()' id='140180442943056'>
      # - type: state_contains
        # data: ["use_check_date", false] # 'use_check_date': <MagicMock name='mock.bot.api_client.get_user_language_settings().__getitem__().__getitem__()' id='140630788853040'>
      - type: keyboard_contains
        button_text: "‚ùå –ò—Å–∫–ª—é—á–µ–Ω–Ω—ã–µ —Å–ª–æ–≤–∞"
  
  # –®–∞–≥ 6: –ü–µ—Ä–µ–∫–ª—é—á–∞–µ–º –Ω–∞—Å—Ç—Ä–æ–π–∫—É —É—á–µ—Ç–∞ –¥–∞—Ç—ã –ø—Ä–æ–≤–µ—Ä–∫–∏
  - type: callback
    data: CallbackData.SETTINGS_TOGGLE_CHECK_DATE
    asserts:
      - type: message_contains
        text: "–¢–µ–∫—É—â–∏–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏"
      - type: message_contains
        text: "–ò—Å–∫–ª—é—á–µ–Ω–Ω—ã–µ —Å–ª–æ–≤–∞: <b>–ü—Ä–æ–ø—É—Å–∫–∞—Ç—å ‚ùå</b>"
      # - type: message_contains
      #   text: "–ü–µ—Ä–∏–æ–¥ –ø–æ–≤—Ç–æ—Ä–µ–Ω–∏—è: <b>–ù–µ —É—á–∏—Ç—ã–≤–∞—Ç—å ‚ùå</b>" # TODO —Å–µ–π—á–∞—Å –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –ü–µ—Ä–∏–æ–¥ –ø–æ–≤—Ç–æ—Ä–µ–Ω–∏—è: <b>–£—á–∏—Ç—ã–≤–∞—Ç—å ‚úÖ (–ø–æ–∫–∞–∑—ã–≤–∞—Ç—å —Å–ª–æ–≤–æ —Ç–æ–ª—å–∫–æ –ø–æ—Å–ª–µ –¥–∞—Ç—ã –ø—Ä–æ–≤–µ—Ä–∫–∏)</b>
      # - type: state_contains
      #   data: ["use_check_date", false] # 'use_check_date': <MagicMock name='mock.bot.api_client.get_user_language_settings().__getitem__().__getitem__()' id='140630788853040'>
      # - type: keyboard_contains
      #   button_text: "üìÖ –ü–µ—Ä–∏–æ–¥ –ø—Ä–æ–≤–µ—Ä–∫–∏: —Å–º–µ–Ω–∏—Ç—å –Ω–∞ \"–£—á–∏—Ç—ã–≤–∞—Ç—å\"" # TODO —Å–µ–π—á–∞—Å –Ω–∞–æ–±–æ—Ä–æ—Ç
        