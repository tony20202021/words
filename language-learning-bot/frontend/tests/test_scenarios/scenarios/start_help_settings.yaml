name: Start-Help-Settings Scenario
user_id: 123456789
api_mock: common
auto_setup: true
steps:
  - type: command
    name: start
    asserts:
      - type: message_contains
        position: -4
        text: "–ó–¥—Ä–∞–≤—Å—Ç–≤—É–π—Ç–µ"
      - type: message_contains
        position: -4
        text: "–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ –±–æ—Ç –¥–ª—è –∏–∑—É—á–µ–Ω–∏—è –∏–Ω–æ—Å—Ç—Ä–∞–Ω–Ω—ã—Ö —Å–ª–æ–≤"
      - type: message_contains
        text: "–ù–∞—á–Ω–∏—Ç–µ —Å –≤—ã–±–æ—Ä–∞ —è–∑—ã–∫–∞ –¥–ª—è –∏–∑—É—á–µ–Ω–∏—è"
      # - type: state_contains
      #   data: ["_state", None] # TODO —Å–µ–π—á–∞—Å —Å–æ—Å—Ç–æ—è–Ω–∏–µ –æ—á–∏—â–µ–Ω–æ –ø–æ–ª–Ω–æ—Å—Ç—å—é
      # - type: check_no_keyboard # TODO
  
  - type: command
    name: help
    asserts:
      - type: message_contains
        text: "–°–ø—Ä–∞–≤–∫–∞ –ø–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é –±–æ—Ç–∞"
      - type: message_contains
        text: "–≠—Ç–æ—Ç –±–æ—Ç –ø–æ–º–æ–∂–µ—Ç –≤–∞–º —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ –∏–∑—É—á–∞—Ç—å –∏–Ω–æ—Å—Ç—Ä–∞–Ω–Ω—ã–µ —Å–ª–æ–≤–∞"
      - type: message_contains
        text: "–°–∏—Å—Ç–µ–º–∞ –∏–Ω—Ç–µ—Ä–≤–∞–ª—å–Ω–æ–≥–æ –ø–æ–≤—Ç–æ—Ä–µ–Ω–∏—è"
      - type: message_contains
        text: "–û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã"
      # - type: state_contains
      #   data: ["_state", None] # TODO —Å–µ–π—á–∞—Å —Å–æ—Å—Ç–æ—è–Ω–∏–µ –æ—á–∏—â–µ–Ω–æ –ø–æ–ª–Ω–æ—Å—Ç—å—é

  - type: command
    name: settings
    asserts:
      - type: message_contains
        position: -1
        text: "–°–Ω–∞—á–∞–ª–∞ –≤—ã–±–µ—Ä–∏—Ç–µ —è–∑—ã–∫ –¥–ª—è –∏–∑—É—á–µ–Ω–∏—è —Å –ø–æ–º–æ—â—å—é –∫–æ–º–∞–Ω–¥—ã /language"

  # –®–∞–≥ 3: –ò–º–∏—Ç–∏—Ä—É–µ–º –≤—ã–±–æ—Ä —è–∑—ã–∫–∞ —á–µ—Ä–µ–∑ callback
  # –í–º–µ—Å—Ç–æ state_update –∏—Å–ø–æ–ª—å–∑—É–µ–º –ø—Ä—è–º–æ–π –≤—ã–∑–æ–≤ –∫–æ–ª–±—ç–∫–∞
  - type: callback
    data: "lang_select_eng"
    asserts:
      - type: message_contains
        text: "–í—ã –≤—ã–±—Ä–∞–ª–∏ —è–∑—ã–∫: <b>–ê–Ω–≥–ª–∏–π—Å–∫–∏–π (English)</b>"
      - type: message_contains
        text: "–í–∞—à–∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –¥–ª—è —ç—Ç–æ–≥–æ —è–∑—ã–∫–∞"
      - type: message_contains
        text: "–ò—Å–∫–ª—é—á–µ–Ω–Ω—ã–µ —Å–ª–æ–≤–∞: <b>–ü—Ä–æ–ø—É—Å–∫–∞—Ç—å ‚ùå</b>"
      - type: message_contains
        text: "–ü–µ—Ä–∏–æ–¥ –ø–æ–≤—Ç–æ—Ä–µ–Ω–∏—è: <b>–£—á–∏—Ç—ã–≤–∞—Ç—å ‚úÖ</b>"
      - type: message_contains
        text: "–ù–∞—á–∞—Ç—å –∏–∑—É—á–µ–Ω–∏–µ: /study"
      - type: state_contains
        data: ["_state", None]
      - type: state_contains
        data: ["current_language", {"id": "eng", "name_ru": "–ê–Ω–≥–ª–∏–π—Å–∫–∏–π", "name_foreign": "English"}]

  # –®–∞–≥ 4: –û—Ç–∫—Ä—ã–≤–∞–µ–º –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —Å–Ω–æ–≤–∞
  - type: command
    name: settings
    asserts:
      - type: message_contains
        text: "–¢–µ–∫—É—â–∏–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏"
      - type: message_contains
        text: "–ò—Å–∫–ª—é—á–µ–Ω–Ω—ã–µ —Å–ª–æ–≤–∞: <b>–ü—Ä–æ–ø—É—Å–∫–∞—Ç—å ‚ùå</b>"
      - type: message_contains
        text: "–ü–µ—Ä–∏–æ–¥ –ø–æ–≤—Ç–æ—Ä–µ–Ω–∏—è: <b>–£—á–∏—Ç—ã–≤–∞—Ç—å ‚úÖ</b>"
      - type: state_contains
        data: ["_state", SettingsStates:viewing_settings]
      - type: keyboard_contains
        button_text: "‚ùå –ò—Å–∫–ª—é—á–µ–Ω–Ω—ã–µ —Å–ª–æ–≤–∞"
      - type: keyboard_contains
        button_text: "‚úÖ –£—á–∏—Ç—ã–≤–∞—Ç—å –¥–∞—Ç—É"
      - type: keyboard_button_count
        count: 13

  - type: callback
    data: CallbackData.SETTINGS_START_WORD
    asserts:
      - type: message_contains
        text: "–í–≤–µ–¥–∏—Ç–µ –Ω–æ–º–µ—Ä —Å–ª–æ–≤–∞"
      # - type: message_contains
      #   text: "–¢–µ–∫—É—â–µ–µ –∑–Ω–∞—á–µ–Ω–∏–µ: 1" # –∏—Å–ø—Ä–∞–≤–∏—Ç—å –º–æ–∫ –¢–µ–∫—É—â–µ–µ –∑–Ω–∞—á–µ–Ω–∏–µ: <MagicMock name='mock.bot.api_client.get_user_language_settings().__getitem__().get()' id='139925770577440'>
      - type: message_contains
        text: "–ò–ª–∏ –æ—Ç–ø—Ä–∞–≤—å—Ç–µ /cancel –¥–ª—è –æ—Ç–º–µ–Ω—ã"
      - type: state_contains
        data: ["_state", SettingsStates:waiting_start_word]

  - type: message
    text: "50"
    asserts:
      - type: message_contains
        position: -2
        text: "–ù–∞—á–∞–ª—å–Ω–æ–µ —Å–ª–æ–≤–æ –∏–∑–º–µ–Ω–µ–Ω–æ –Ω–∞: <b>50</b>"
      - type: message_contains
        text: "–û–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –æ–±—É—á–µ–Ω–∏—è"
      # - type: message_contains
      #   text: "–ù–∞—á–∞–ª—å–Ω–æ–µ —Å–ª–æ–≤–æ: <b>50</b>" # TODO –∏—Å–ø—Ä–∞–≤–∏—Ç—å –º–æ–∫ –ù–∞—á–∞–ª—å–Ω–æ–µ —Å–ª–æ–≤–æ: <b><MagicMock name='mock.bot.api_client.get_user_language_settings().__getitem__().get()' id='140124756108016'></b>
      - type: state_contains
        data: ["_state", SettingsStates:viewing_settings] # TODO –∏—Å–ø—Ä–∞–≤–∏—Ç—å –∏—Å—Ö–æ–¥–Ω—ã–π –∫–æ–¥ - –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å NONE
      - type: keyboard_contains
        button_text: "üî¢ –ò–∑–º–µ–Ω–∏—Ç—å –Ω–∞—á–∞–ª—å–Ω–æ–µ —Å–ª–æ–≤–æ"
        